{"version":3,"file":"conversationService-d7030955.js","sources":["../../src/features/chat/services/conversationService.js"],"sourcesContent":["// ëŒ€í™” ì €ìž¥ ë° ê´€ë¦¬ ì„œë¹„ìŠ¤\nimport { API_BASE_URL } from '../../../config';\n\nclass ConversationService {\n  constructor() {\n    this.userId = this.getUserId();\n  }\n\n  // ì‚¬ìš©ìž ID ê°€ì ¸ì˜¤ê¸° (ì¸ì¦ëœ ì‚¬ìš©ìž ì •ë³´ ì‚¬ìš©)\n  getUserId() {\n    const userInfo = JSON.parse(localStorage.getItem(\"userInfo\") || \"{}\");\n    // UUID(username)ë¥¼ ìš°ì„  ì‚¬ìš©í•˜ë˜, ì—†ìœ¼ë©´ userId ë˜ëŠ” email ì‚¬ìš©\n    return (\n      userInfo.username || userInfo.userId || userInfo.email || \"anonymous\"\n    );\n  }\n\n  // ì¸ì¦ í—¤ë” ìƒì„±\n  getAuthHeaders() {\n    const token = localStorage.getItem(\"authToken\");\n    const headers = {\n      \"Content-Type\": \"application/json\",\n    };\n\n    if (token) {\n      headers[\"Authorization\"] = `Bearer ${token}`;\n    }\n\n    return headers;\n  }\n\n  // ëŒ€í™” ì €ìž¥\n  async saveConversation(conversationData) {\n    try {\n      // conversationDataì— ì´ë¯¸ userIdê°€ ìžˆìœ¼ë©´ ê·¸ê²ƒì„ ì‚¬ìš©, ì—†ìœ¼ë©´ this.userId ì‚¬ìš©\n      const dataToSave = {\n        ...conversationData,\n        userId: conversationData.userId || this.getUserId(), // getUserId() í˜¸ì¶œí•˜ì—¬ ìµœì‹  userId ê°€ì ¸ì˜¤ê¸°\n      };\n      \n      // ì €ìž¥í•  ë°ì´í„° ë¡œê·¸ (í•„ìš”ì‹œ ì£¼ì„ í•´ì œ)\n      // console.log(\"ðŸ’¾ ì €ìž¥í•  ë°ì´í„°:\", {\n      //   conversationId: dataToSave.conversationId,\n      //   userId: dataToSave.userId,\n      //   engineType: dataToSave.engineType,\n      //   messageCount: dataToSave.messages?.length\n      // });\n      \n      const response = await fetch(`${API_BASE_URL}/conversations`, {\n        method: \"POST\",\n        headers: this.getAuthHeaders(),\n        body: JSON.stringify(dataToSave),\n      });\n\n      if (!response.ok) {\n        throw new Error(`Failed to save conversation: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      // console.log(\"ðŸ’¾ ëŒ€í™” ì €ìž¥ ì„±ê³µ:\", data);\n      return data;\n    } catch (error) {\n      console.error(\"ëŒ€í™” ì €ìž¥ ì‹¤íŒ¨:\", error);\n      // ì˜¤ë¥˜ ë°œìƒ ì‹œ localStorageì— ë°±ì—…\n      this.saveToLocalStorage(conversationData);\n      throw error;\n    }\n  }\n\n  // ëŒ€í™” ëª©ë¡ ì¡°íšŒ\n  async listConversations(engineType = null) {\n    try {\n      const currentUserId = this.getUserId(); // ìµœì‹  userId ê°€ì ¸ì˜¤ê¸°\n      const params = new URLSearchParams({\n        userId: currentUserId,\n      });\n\n      if (engineType) {\n        params.append(\"engineType\", engineType); // engineType íŒŒë¼ë¯¸í„° ì‚¬ìš© (ë°±ì—”ë“œ API ìŠ¤íŽ™ì— ë§žì¶¤)\n      }\n      \n      // console.log(\"ðŸ“‹ ëŒ€í™” ëª©ë¡ ì¡°íšŒ íŒŒë¼ë¯¸í„°:\", {\n      //   userId: currentUserId,\n      //   engineType: engineType\n      // });\n\n      const response = await fetch(`${API_BASE_URL}/conversations?${params}`, {\n        method: \"GET\",\n        headers: this.getAuthHeaders(),\n      });\n\n      if (!response.ok) {\n        throw new Error(`Failed to list conversations: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      // console.log(\"ðŸ“‹ ëŒ€í™” ëª©ë¡ ì¡°íšŒ ì„±ê³µ:\", data);\n      return data.conversations || [];\n    } catch (error) {\n      console.error(\"ëŒ€í™” ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:\", error);\n      // ì˜¤ë¥˜ ë°œìƒ ì‹œ localStorageì—ì„œ ì¡°íšŒ\n      return this.getFromLocalStorage(engineType);\n    }\n  }\n\n  // íŠ¹ì • ëŒ€í™” ì¡°íšŒ\n  async getConversation(conversationId) {\n    try {\n      const response = await fetch(\n        `${API_BASE_URL}/conversations/${conversationId}`,\n        {\n          method: \"GET\",\n          headers: this.getAuthHeaders(),\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error(`Failed to get conversation: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      // console.log(\"ðŸ“– ëŒ€í™” ì¡°íšŒ ì„±ê³µ:\", data);\n      return data;\n    } catch (error) {\n      console.error(\"ëŒ€í™” ì¡°íšŒ ì‹¤íŒ¨:\", error);\n      // ì˜¤ë¥˜ ë°œìƒ ì‹œ localStorageì—ì„œ ì¡°íšŒ\n      return this.getConversationFromLocalStorage(conversationId);\n    }\n  }\n\n  // ëŒ€í™” ì œëª© ìˆ˜ì • (PATCH ìš”ì²­)\n  async updateConversationTitle(conversationId, newTitle) {\n    try {\n      const response = await fetch(\n        `${API_BASE_URL}/conversations/${conversationId}`,\n        {\n          method: \"PATCH\",\n          headers: {\n            ...this.getAuthHeaders(),\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify({\n            title: newTitle,\n          }),\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error(`Failed to update title: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      console.log(\"âœï¸ ì œëª© ìˆ˜ì • API ì‘ë‹µ:\", data);\n      \n      // localStorageë„ ì—…ë°ì´íŠ¸\n      this.updateLocalStorageTitle(conversationId, newTitle);\n      \n      return data;\n    } catch (error) {\n      console.error(\"ì œëª© ìˆ˜ì • ì‹¤íŒ¨:\", error);\n      // ì˜¤ë¥˜ ë°œìƒ ì‹œ localStorageë§Œ ì—…ë°ì´íŠ¸\n      this.updateLocalStorageTitle(conversationId, newTitle);\n      throw error;\n    }\n  }\n\n  // localStorage ì œëª© ì—…ë°ì´íŠ¸\n  updateLocalStorageTitle(conversationId, newTitle) {\n    try {\n      // conversationsëŠ” object í˜•íƒœë¡œ ì €ìž¥ë˜ì–´ ìžˆìŒ\n      const conversations = JSON.parse(localStorage.getItem(\"conversations\") || \"{}\");\n      \n      // conversationIdë¡œ í•´ë‹¹ ëŒ€í™”ë¥¼ ì°¾ìŒ\n      const key = Object.keys(conversations).find(\n        k => conversations[k].conversationId === conversationId\n      );\n      \n      if (key && conversations[key]) {\n        conversations[key].title = newTitle;\n        conversations[key].updatedAt = new Date().toISOString();\n        localStorage.setItem(\"conversations\", JSON.stringify(conversations));\n        console.log(\"âœï¸ localStorage ì œëª© ì—…ë°ì´íŠ¸ ì„±ê³µ\");\n      } else {\n        // localStorageì— ì—†ëŠ” ê²½ìš° ì„œë²„ì—ì„œ ê°€ì ¸ì˜¨ ëŒ€í™”ì´ë¯€ë¡œ ìƒˆë¡œ ìƒì„±\n        const currentUserId = this.getUserId();\n        const newKey = `conversation_${conversationId}`;\n        conversations[newKey] = {\n          conversationId: conversationId,\n          userId: currentUserId,\n          title: newTitle,\n          messages: [],\n          createdAt: new Date().toISOString(),\n          updatedAt: new Date().toISOString()\n        };\n        localStorage.setItem(\"conversations\", JSON.stringify(conversations));\n        console.log(\"âœï¸ localStorageì— ìƒˆ ëŒ€í™” ìƒì„± ë° ì œëª© ì„¤ì •\");\n      }\n    } catch (error) {\n      console.error(\"localStorage ì œëª© ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:\", error);\n    }\n  }\n\n  // ëŒ€í™” ì‚­ì œ\n  async deleteConversation(conversationId) {\n    try {\n      const params = new URLSearchParams({\n        userId: this.userId,\n      });\n\n      const response = await fetch(\n        `${API_BASE_URL}/conversations/${conversationId}?${params}`,\n        {\n          method: \"DELETE\",\n          headers: this.getAuthHeaders(),\n        }\n      );\n\n      if (!response.ok) {\n        console.warn(\"ì„œë²„ì—ì„œ ì‚­ì œ ì‹¤íŒ¨, localStorageì—ì„œë§Œ ì‚­ì œ ì‹œë„\");\n      } else {\n        // console.log(\"ðŸ—‘ï¸ ì„œë²„ì—ì„œ ëŒ€í™” ì‚­ì œ ì„±ê³µ\");\n      }\n\n      // localStorageì—ì„œë„ ì‚­ì œ (ì„œë²„ ì‚­ì œ ì‹¤íŒ¨í•´ë„ ë¡œì»¬ì€ ì‚­ì œ)\n      this.deleteFromLocalStorage(conversationId);\n\n      // ëŒ€í™” ížˆìŠ¤í† ë¦¬ë„ ì‚­ì œ\n      const conversations = JSON.parse(\n        localStorage.getItem(\"conversations\") || \"{}\"\n      );\n      const conv = Object.values(conversations).find(\n        (c) => c.conversationId === conversationId\n      );\n      if (conv && conv.engineType) {\n        const historyKey = `chat_history_${conv.engineType}`;\n        const history = localStorage.getItem(historyKey);\n        if (history) {\n          const messages = JSON.parse(history);\n          // í•´ë‹¹ ëŒ€í™”ì˜ ë©”ì‹œì§€ë§Œ ì œê±°\n          const filteredMessages = messages.filter(\n            (m) => !m.conversationId || m.conversationId !== conversationId\n          );\n          if (filteredMessages.length === 0) {\n            localStorage.removeItem(historyKey);\n          } else {\n            localStorage.setItem(historyKey, JSON.stringify(filteredMessages));\n          }\n        }\n      }\n\n      return true;\n    } catch (error) {\n      console.error(\"ëŒ€í™” ì‚­ì œ ì¤‘ ì˜¤ë¥˜:\", error);\n      // ì„œë²„ ì˜¤ë¥˜ì—¬ë„ localStorageëŠ” ì‚­ì œ\n      this.deleteFromLocalStorage(conversationId);\n      return true;\n    }\n  }\n\n  // ìžë™ ì €ìž¥ (debounced)\n  autoSave(conversationData) {\n    // ì´ì „ íƒ€ì´ë¨¸ê°€ ìžˆìœ¼ë©´ ì·¨ì†Œ\n    if (this.saveTimer) {\n      clearTimeout(this.saveTimer);\n    }\n\n    // 3ì´ˆ í›„ì— ì €ìž¥ (localStorageë§Œ ì‚¬ìš©)\n    this.saveTimer = setTimeout(() => {\n      // API í˜¸ì¶œ ëŒ€ì‹  localStorageì—ë§Œ ì €ìž¥\n      this.saveToLocalStorage(conversationData);\n    }, 3000);\n  }\n\n  // === localStorage ë°±ì—… ë©”ì„œë“œë“¤ ===\n\n  saveToLocalStorage(conversationData) {\n    try {\n      const conversations = JSON.parse(\n        localStorage.getItem(\"conversations\") || \"{}\"\n      );\n      const conversationId =\n        conversationData.conversationId || crypto.randomUUID();\n      const key = `conversation_${conversationData.engineType}_${conversationId}`;\n\n      // ì´ë¯¸ ì¡´ìž¬í•˜ëŠ” ëŒ€í™”ì¸ì§€ í™•ì¸\n      const existingKey = Object.keys(conversations).find(\n        (k) => conversations[k].conversationId === conversationId\n      );\n\n      if (existingKey) {\n        // ê¸°ì¡´ ëŒ€í™” ì—…ë°ì´íŠ¸ (ì¤‘ë³µ ë°©ì§€)\n        conversations[existingKey] = {\n          ...conversations[existingKey],\n          ...conversationData,\n          userId: this.userId,\n          updatedAt: new Date().toISOString(),\n        };\n      } else {\n        // ìƒˆë¡œìš´ ëŒ€í™” ìƒì„±\n        conversations[key] = {\n          ...conversationData,\n          conversationId,\n          userId: this.userId,\n          createdAt: new Date().toISOString(),\n          updatedAt: new Date().toISOString(),\n        };\n      }\n\n      localStorage.setItem(\"conversations\", JSON.stringify(conversations));\n      // console.log(\"ðŸ’¾ localStorageì— ì €ìž¥:\", existingKey ? \"ì—…ë°ì´íŠ¸\" : \"ì‹ ê·œ\");\n    } catch (error) {\n      console.error(\"localStorage ì €ìž¥ ì‹¤íŒ¨:\", error);\n    }\n  }\n\n  getFromLocalStorage(engineType = null) {\n    try {\n      const conversations = JSON.parse(\n        localStorage.getItem(\"conversations\") || \"{}\"\n      );\n      let conversationList = Object.values(conversations);\n\n      // ì‚¬ìš©ìž í•„í„°ë§\n      conversationList = conversationList.filter(\n        (conv) => conv.userId === this.userId\n      );\n\n      // ì—”ì§„ íƒ€ìž… í•„í„°ë§\n      if (engineType) {\n        conversationList = conversationList.filter(\n          (conv) => conv.engineType === engineType\n        );\n      }\n\n      // ìµœì‹ ìˆœ ì •ë ¬\n      conversationList.sort(\n        (a, b) => new Date(b.updatedAt) - new Date(a.updatedAt)\n      );\n\n      return conversationList;\n    } catch (error) {\n      console.error(\"localStorage ì¡°íšŒ ì‹¤íŒ¨:\", error);\n      return [];\n    }\n  }\n\n  getConversationFromLocalStorage(conversationId) {\n    try {\n      const conversations = JSON.parse(\n        localStorage.getItem(\"conversations\") || \"{}\"\n      );\n      const conversation = Object.values(conversations).find(\n        (conv) =>\n          conv.conversationId === conversationId && conv.userId === this.userId\n      );\n      return conversation || null;\n    } catch (error) {\n      console.error(\"localStorage ì¡°íšŒ ì‹¤íŒ¨:\", error);\n      return null;\n    }\n  }\n\n  deleteFromLocalStorage(conversationId) {\n    try {\n      const conversations = JSON.parse(\n        localStorage.getItem(\"conversations\") || \"{}\"\n      );\n      const key = Object.keys(conversations).find(\n        (k) =>\n          conversations[k].conversationId === conversationId &&\n          conversations[k].userId === this.userId\n      );\n      if (key) {\n        delete conversations[key];\n        localStorage.setItem(\"conversations\", JSON.stringify(conversations));\n        // console.log(\"ðŸ—‘ï¸ localStorageì—ì„œ ì‚­ì œ\");\n      }\n    } catch (error) {\n      console.error(\"localStorage ì‚­ì œ ì‹¤íŒ¨:\", error);\n    }\n  }\n\n  // ëŒ€í™” ë™ê¸°í™” (localStorage â†’ DynamoDB)\n  async syncConversations() {\n    try {\n      const localConversations = this.getFromLocalStorage();\n      console.log(`ðŸ”„ ${localConversations.length}ê°œ ëŒ€í™” ë™ê¸°í™” ì‹œìž‘`);\n\n      for (const conversation of localConversations) {\n        try {\n          await this.saveConversation(conversation);\n        } catch (error) {\n          console.error(\n            \"ëŒ€í™” ë™ê¸°í™” ì‹¤íŒ¨:\",\n            conversation.conversationId,\n            error\n          );\n        }\n      }\n\n      console.log(\"âœ… ëŒ€í™” ë™ê¸°í™” ì™„ë£Œ\");\n    } catch (error) {\n      console.error(\"ëŒ€í™” ë™ê¸°í™” ì‹¤íŒ¨:\", error);\n    }\n  }\n}\n\n// ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤\nconst conversationService = new ConversationService();\n\nexport default conversationService;\n\n// íŽ¸ì˜ í•¨ìˆ˜ë“¤\nexport const saveConversation = (data) =>\n  conversationService.saveConversation(data);\nexport const listConversations = (engineType) =>\n  conversationService.listConversations(engineType);\nexport const getConversation = (id) => conversationService.getConversation(id);\nexport const deleteConversation = (id) =>\n  conversationService.deleteConversation(id);\nexport const updateConversationTitle = (id, title) =>\n  conversationService.updateConversationTitle(id, title);\nexport const autoSaveConversation = (data) =>\n  conversationService.autoSave(data);\nexport const syncConversations = () => conversationService.syncConversations();\n"],"names":["ConversationService","userInfo","token","headers","conversationData","dataToSave","response","API_BASE_URL","error","engineType","currentUserId","params","conversationId","newTitle","data","conversations","key","k","newKey","conv","c","historyKey","history","filteredMessages","m","existingKey","conversationList","a","b","localConversations","conversation","conversationService","saveConversation","listConversations","getConversation","id","deleteConversation","updateConversationTitle","title","autoSaveConversation","syncConversations"],"mappings":"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"}