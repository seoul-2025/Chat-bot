#!/bin/bash

# 전체 배포 자동화 스크립트
# 사용법: ./deploy-all.sh

set -e

echo "================================================"
echo "Nexus Multi 전체 배포 스크립트"
echo "================================================"
echo ""
echo "이 스크립트는 다음 작업을 순서대로 수행합니다:"
echo "1. S3 버킷 생성"
echo "2. CloudFront 배포 생성"
echo "3. 프론트엔드 빌드 및 배포"
echo ""
echo "⚠️ 주의: AWS 계정에 요금이 발생할 수 있습니다."
echo ""
echo "계속하시겠습니까? (y/n)"
read -r response

if [[ "$response" != "y" ]]; then
    echo "취소되었습니다."
    exit 0
fi

# 스크립트 실행 권한 부여
chmod +x *.sh

# 1. S3 버킷 생성
echo ""
echo "=========================================="
echo "단계 1: S3 버킷 생성"
echo "=========================================="
./01-create-s3-bucket.sh

# 2. CloudFront 배포 생성
echo ""
echo "=========================================="
echo "단계 2: CloudFront 배포 생성"
echo "=========================================="
./02-create-cloudfront.sh

# 3. 프론트엔드 배포
echo ""
echo "=========================================="
echo "단계 3: 프론트엔드 빌드 및 배포"
echo "=========================================="
./03-deploy-frontend.sh

echo ""
echo "================================================"
echo "전체 배포 완료!"
echo "================================================"
echo ""
echo "배포 정보는 deployment-config.json 파일에서 확인하세요."
echo "================================================"